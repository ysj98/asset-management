(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6436dc01"],{"0538":function(e,t,a){"use strict";var n=a("b277");a.n(n).a},"19bd":function(e,t,a){"use strict";a("efce"),a("4634"),a("ed8b");var n=a("97a3"),o=a("dea4");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}a("7cfd"),a("8f42");var i={components:{},props:{default:{type:Boolean,default:!0},allowClear:{type:Boolean,default:!0},placeholder:{type:String,default:"请选择组织机构树"},typeFilter:{type:String,default:""},value:{type:[String,Number],default:""},disabled:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},treeCheckable:{type:Boolean,default:!1},treeDefaultExpandAll:{type:Boolean,default:!1},dropdownStyle:{type:Object,default:function(){return{maxHeight:"400px",overflow:"auto"}}}},data:function(){return{organId:"",treeData:[]}},computed:{},methods:{initDepartment:function(){var e=this;this.$api.assets.queryAsynOrganByUserId({parentOrganId:"",typeFilter:this.typeFilter}).then((function(t){0===Number(t.data.code)&&(e.treeData=e.mapTreeNodes(t.data.data),e.default&&(e.organId=e.treeData[0].organId,e.organName=e.treeData[0].name,e.$emit("changeTree",e.organId,e.organName)))}))},onLoadData:function(e){var t=this;return new Promise((function(a){t.$api.assets.queryAsynOrganByUserId({parentOrganId:e.value,typeFilter:t.typeFilter}).then((function(n){if(0===Number(n.data.code)){var r=t.mapTreeNodes(n.data.data);t.setTree(e.value,t.treeData,r),t.treeData=Object(o.a)(t.treeData),a()}}))}))},setTree:function(e,t,a){for(var n=0;n<t.length;n++){if(Number(t[n].key)===Number(e))return void(t[n].children=Object(o.a)(a));t[n].children&&0<t[n].children.length&&this.setTree(e,t[n].children,a)}},mapTreeNodes:function(e){return e.map((function(e){var t=e.organId,a=e.name;return e.title=a,e.key=t,e.value=e.organId,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)}))},changeTree:function(e,t){this.multiple?(this.$emit("changeTree",e,t),this.organName=t):(this.$emit("changeTree",e,t[0]),this.organName=t[0]),this.organId=e}},created:function(){},mounted:function(){this.organId=this.value,this.initDepartment()}},s=a("6691"),l=Object(s.a)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("a-tree-select",{attrs:{multiple:e.multiple,showSearch:e.showSearch,dropdownStyle:e.dropdownStyle,treeData:e.treeData,placeholder:e.placeholder,allowClear:e.allowClear,loadData:e.onLoadData,disabled:e.disabled,treeCheckable:e.treeCheckable,treeDefaultExpandAll:e.treeDefaultExpandAll},on:{change:e.changeTree},model:{value:e.organId,callback:function(t){e.organId=t},expression:"organId"}})}),[],!1,null,"276f30da",null);t.a=l.exports},"2f06":function(e,t,a){"use strict";var n=a("6a8b");a.n(n).a},"41a7":function(e,t,a){var n=a("da0b"),o=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&o(e)===e}},"5e4c":function(e,t,a){"use strict";a.r(t),a("4634");var n=a("65c7"),o=a("19bd"),r=a("c32d"),i=a.n(r),s={name:"SegiRangePicker",components:{ARangePicker:a("4e72").DatePicker.RangePicker},props:{label:{type:String,default:"起止时间"},format:{type:String,default:"YYYY-MM-DD"},placeholder:{type:Array,default:function(){return["开始日期","结束日期"]}},defaultValue:{type:Array,default:function(){return[]}},value:{type:Array,default:function(){return[]}},mode:{type:Array,default:function(){return["date","date"]}},canSelectToday:{type:Boolean,default:!1}},data:function(){return{showDateModal:!1,dateValue:[]}},watch:{value:function(e){this.dateValue=e}},methods:{moment:i.a,disabledDate:function(e){if(this.canSelectToday)return e>i()().endOf("day");var t=new Date(new Date-864e5);return e>i()(t,"YYYY-MM-DD")},openDateModal:function(){this.showDateModal=!0},handlePanelChange:function(e){this.dateValue=e,this.$emit("dateChange",e)},onEnteringDateChange:function(e,t){var a=new Date(t[0]),n=new Date(t[1]);if(a.setFullYear(a.getFullYear()+3),a<n)this.showDateModal=!1,this.$message.warning("时间范围跨度不能超过3年");else{this.dateValue=e;var o=document.getElementsByClassName("entering-date-border")[0];o.childNodes[1].childNodes[0].style.boxShadow="none",o.classList.add("focus-input"),this.showDateModal=!1,this.$emit("dateChange",t)}}},mounted:function(){this.dateValue=this.defaultValue;var e=document.getElementsByClassName("entering-date-border")[0],t=this;document.onmousedown=function(a){setTimeout((function(){var n=document.getElementsByClassName("ant-calendar-picker-container")[0];e.contains(a.target)||n&&n.contains(a.target)||(e.classList.remove("focus-input"),t.showDateModal=!1)}),200)}}},l=(a("0538"),a("6691")),c=Object(l.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"entering-date",on:{click:e.openDateModal}},[a("div",{staticClass:"entering-date-border"},[a("div",{staticClass:"entering-date-label"},[e._v(e._s(e.label))]),a("a-range-picker",{attrs:{allowClear:!1,placeholder:e.placeholder,format:e.format,mode:e.mode,value:e.dateValue,open:e.showDateModal,disabledDate:e.disabledDate},on:{change:e.onEnteringDateChange,panelChange:e.handlePanelChange}})],1)])}),[],!1,null,"86cef9b4",null).exports;a("8f42"),a("c11a"),a("e6d1"),a("c041");var u=[{title:"清理单编号",dataIndex:"cleaningOrderCode",width:160},{title:"管理机构",dataIndex:"organName",width:160},{title:"资产项目名称",dataIndex:"projectName",width:160},{title:"资产类型",dataIndex:"assetTypeName",width:160},{title:"资产数量",dataIndex:"assetCount",width:120},{title:"清理原因",dataIndex:"cleanupTypeName",width:160},{title:"创建日期",dataIndex:"createTime",width:160},{title:"创建人",dataIndex:"createByName",width:120},{title:"当前状态",dataIndex:"approvalStatusName",width:120},{title:"操作",width:160,dataIndex:"operation",scopedSlots:{customRender:"operation"}}],d=[{label:"全部状态",value:""},{label:"草稿",value:"0"},{label:"待审批",value:"2"},{label:"已驳回",value:"3"},{label:"已审批",value:"1"},{label:"已取消",value:"4"}],p={components:{SearchContainer:n.a,TreeSelect:o.a,SegiRangePicker:c},data:function(){return{allStyle:"width: 170px; margin-right: 10px;",toggle:!1,columns:u,organName:"",organId:"",dataSource:[],approvalStatusData:[].concat(d),assetProjectOptions:[{label:"全部资产项目",value:""},{label:"公建2019",value:"1"},{label:"廉租房2018",value:"2"}],assetTypeOptions:[{label:"全部资产类型",value:""},{label:"房屋",value:"1"},{label:"构筑物",value:"2"},{label:"设备",value:"3"}],queryCondition:{approvalStatus:[""],assetProject:"",assetType:[""],beginDate:function(){var e=new Date((new Date).getTime()-7776e6),t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),t+"-"+a+"-"+n}(),endDate:function(){var e=new Date,t=parseInt(e.getMonth()+1),a=e.getDate();return t<10&&(t="0"+t),a<10&&(a="0"+a),e.getFullYear()+"-"+t+"-"+a}(),onlyCurrentOrgan:!1},paginator:{pageNo:1,pageLength:10,totalCount:0}}},methods:{moment:i.a,searchContainerFn:function(e){this.toggle=e},changeTree:function(e,t){this.organName=t,this.organId=e,this.queryClick()},changeStatus:function(e){this.$nextTick((function(){this.queryCondition.approvalStatus=this.handleMultipleSelectValue(e,this.queryCondition.approvalStatus,this.approvalStatusData)}))},changeAssetType:function(e){this.$nextTick((function(){this.queryCondition.assetType=this.handleMultipleSelectValue(e,this.queryCondition.assetType,this.assetTypeOptions)}))},handleMultipleSelectValue:function(e,t,a){if(""===e)t=[""];else{var n=t.indexOf("");-1<n?t.splice(n,1):t.length===a.length-1&&(t=[""])}return t},filterOption:function(e,t){return 0<=t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())},onDateChange:function(e){this.queryCondition.beginDate=e[0],this.queryCondition.endDate=e[1]},onOnlyCurrentOrganChange:function(e){this.queryCondition.onlyCurrentOrgan=e.target.checked},handlePageChange:function(e){this.paginator.pageNo=e,this.queryList()},newClearForm:function(){this.$router.push({path:"/assetClear/new",query:{pageType:"new",organId:this.organId,organName:this.organName}})},deleteClearForm:function(e){var t=this;this.$confirm({title:"提示",content:"确认要删除该资产清理单吗？",onOk:function(){var a={cleaningOrderId:e.cleaningOrderId};t.$api.assets.deleteCleanup(a).then((function(e){"0"===e.data.code?(t.$message.success("删除成功"),t.queryList()):t.$message.error(e.data.message)}))}})},antiAudit:function(e){var t=this;this.$confirm({title:"提示",content:"确认要对此清理单反审核吗？",onOk:function(){var a={cleaningOrderId:e.cleaningOrderId};t.$api.assets.reverseApproveCleanup(a).then((function(e){"0"===e.data.code?(t.$message.success("操作成功"),t.queryList()):t.$message.error(e.data.message)}))}})},handleOperation:function(e,t){this.$router.push({path:"/assetClear/"+e,query:{pageType:e,cleaningOrderId:t.cleaningOrderId,organId:this.organId,organName:this.organName}})},queryClick:function(){this.paginator.pageNo=1,this.queryList()},queryList:function(){var e=this,t={organId:this.organId,projectId:this.queryCondition.assetProject,multiAssetType:this.queryCondition.assetType.join(","),multiApprovalStatus:this.queryCondition.approvalStatus.join(","),currentOrganId:this.queryCondition.onlyCurrentOrgan?"1":"0",startCreateDate:this.queryCondition.beginDate,endCreateDate:this.queryCondition.endDate,pageNum:this.paginator.pageNo,pageSize:this.paginator.pageLength};this.$api.assets.getCleanupPage(t).then((function(t){if("0"===t.data.code){var a=t.data.data.data;a.forEach((function(e,t){e.key=t})),e.dataSource=a,e.paginator.totalCount=t.data.data.count}else e.$message.error(t.data.message)}))}},created:function(){},mounted:function(){}},h=(a("2f06"),Object(l.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assets-clear"},[a("SG-SearchContainer",{attrs:{size:"fold",background:"white"},on:{input:e.searchContainerFn},model:{value:e.toggle,callback:function(t){e.toggle=t},expression:"toggle"}},[a("div",{attrs:{slot:"headBtns"},slot:"headBtns"},[a("SG-Button",{attrs:{icon:"plus",type:"primary"},on:{click:e.newClearForm}},[e._v("新建清理单")]),a("div",{staticStyle:{position:"absolute",top:"20px",right:"76px",display:"flex"}},[a("treeSelect",{style:e.allStyle,attrs:{placeholder:"请选择组织机构",allowClear:!1},on:{changeTree:e.changeTree}})],1)],1),a("div",{attrs:{slot:"btns"},slot:"btns"},[a("SG-Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.queryClick}},[e._v("查询")]),a("SG-Button",[e._v("清空")])],1),a("div",{staticClass:"formCon",attrs:{slot:"form"},slot:"form"},[a("a-select",{style:e.allStyle,attrs:{showSearch:"",placeholder:"请选择资产项目",optionFilterProp:"children",options:e.assetProjectOptions,filterOption:e.filterOption},model:{value:e.queryCondition.assetProject,callback:function(t){e.$set(e.queryCondition,"assetProject",t)},expression:"queryCondition.assetProject"}}),a("a-select",{style:e.allStyle,attrs:{maxTagCount:1,mode:"multiple",tokenSeparators:[","],placeholder:"全部状态",options:e.approvalStatusData},on:{select:e.changeStatus},model:{value:e.queryCondition.approvalStatus,callback:function(t){e.$set(e.queryCondition,"approvalStatus",t)},expression:"queryCondition.approvalStatus"}}),a("a-select",{staticStyle:{width:"190px","margin-right":"10px"},attrs:{maxTagCount:1,mode:"multiple",tokenSeparators:[","],placeholder:"全部资产类型",options:e.assetTypeOptions},on:{select:e.changeAssetType},model:{value:e.queryCondition.assetType,callback:function(t){e.$set(e.queryCondition,"assetType",t)},expression:"queryCondition.assetType"}}),a("segi-range-picker",{staticStyle:{"margin-right":"10px"},attrs:{label:"录入时间",defaultValue:[e.moment(e.queryCondition.beginDate,"YYYY-MM-DD"),e.moment(e.queryCondition.endDate,"YYYY-MM-DD")],canSelectToday:!0},on:{dateChange:e.onDateChange}}),a("a-checkbox",{staticStyle:{"line-height":"32px"},attrs:{checked:e.queryCondition.onlyCurrentOrgan},on:{change:e.onOnlyCurrentOrganChange}},[e._v("仅当前机构下资产清理单")])],1)]),a("div"),a("div",[a("a-table",{staticClass:"custom-table",attrs:{columns:e.columns,dataSource:e.dataSource,pagination:!1},scopedSlots:e._u([{key:"operation",fn:function(t,n){return[a("a",{directives:[{name:"show",rawName:"v-show",value:2==+n.approvalStatus,expression:"+record.approvalStatus === 2"}],staticClass:"operation-btn",on:{click:function(t){return e.handleOperation("audit",n)}}},[e._v("审核")]),a("a",{directives:[{name:"show",rawName:"v-show",value:1==+n.approvalStatus,expression:"+record.approvalStatus === 1"}],staticClass:"operation-btn",on:{click:function(t){return e.antiAudit(n)}}},[e._v("反审核")]),a("a",{directives:[{name:"show",rawName:"v-show",value:0==+n.approvalStatus||3==+n.approvalStatus,expression:"+record.approvalStatus === 0 || +record.approvalStatus === 3"}],staticClass:"operation-btn",on:{click:function(t){return e.handleOperation("edit",n)}}},[e._v("编辑")]),a("a",{directives:[{name:"show",rawName:"v-show",value:0==+n.approvalStatus||3==+n.approvalStatus,expression:"+record.approvalStatus === 0 || +record.approvalStatus === 3"}],staticClass:"operation-btn",on:{click:function(t){return e.deleteClearForm(n)}}},[e._v("删除")]),a("a",{staticClass:"operation-btn",on:{click:function(t){return e.handleOperation("detail",n)}}},[e._v("详情")])]}}])})],1),a("SG-FooterPagination",{attrs:{pageLength:e.paginator.pageLength,totalCount:e.paginator.totalCount,location:"absolute"},on:{input:e.handlePageChange},model:{value:e.paginator.pageNo,callback:function(t){e.$set(e.paginator,"pageNo",t)},expression:"paginator.pageNo"}})],1)}),[],!1,null,"4bbb45a7",null));t.default=h.exports},"65c7":function(e,t,a){"use strict";var n={props:{type:{default:"fold"},value:{default:!0},headerStyle:{default:function(){return{}}},contentStyle:{default:function(){return{}}},searchIconStyle:{default:function(){return{}}}},methods:{toggleFold:function(){this.$emit("input",!this.value)}}},o=(a("7fdc"),a("6691")),r=Object(o.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-header",class:[!e.value&&"off"],style:e.headerStyle},[a("div",{staticClass:"search-header-left"},[e._t("headerBtns")],2),a("div",{staticClass:"search-header-right"},[e._t("headerForm")],2),"fold"===e.type?a("div",{staticClass:"search-icon-box",on:{click:e.toggleFold}},[e._t("toggleIcon",[a("a-icon",{staticClass:"search-icon",class:[e.value&&"active"],attrs:{type:"double-right"}})])],2):e._e()]),a("div",{staticClass:"search-content",class:[!e.value&&"off-content"],style:e.contentStyle},[a("div",{staticClass:"content-icon",style:e.searchIconStyle},[e._t("searchIcon",[a("i",{staticClass:"search-icon"})])],2),a("div",{staticClass:"content-form"},[e._t("contentForm")],2)])])}),[],!1,null,"0467bb88",null);t.a=r.exports},"6a8b":function(e,t,a){},"7cfd":function(e,t,a){var n=a("d3d8").f,o=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in o||a("f9a5")&&n(o,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"7fdc":function(e,t,a){"use strict";var n=a("ce69");a.n(n).a},b277:function(e,t,a){},c11a:function(e,t,a){var n=a("2498");n(n.S,"Number",{isInteger:a("41a7")})},ce69:function(e,t,a){}}]);